<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · ClimateModels.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimateModels.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Manual</a><ul class="internal"><li><a class="tocitem" href="#Climate-Model-Interface"><span>Climate Model Interface</span></a></li><li><a class="tocitem" href="#Tracked-Worklow-Support"><span>Tracked Worklow Support</span></a></li><li><a class="tocitem" href="#File-and-Cloud-Support"><span>File and Cloud Support</span></a></li><li><a class="tocitem" href="#Data-Structure"><span>Data Structure</span></a></li><li><a class="tocitem" href="#Methods"><span>Methods</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li><li><a class="tocitem" href="#Notebooks"><span>Notebooks</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Manual</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gaelforget/ClimateModels.jl/blob/master/docs/src/functionalities.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="manual"><a class="docs-heading-anchor" href="#manual">User Manual</a><a id="manual-1"></a><a class="docs-heading-anchor-permalink" href="#manual" title="Permalink"></a></h1><p>Here we document key functionalities offered in <code>ClimateModels.jl</code></p><ul><li>Climate Model Interface</li><li>Tracked Worklow Framework</li><li>Cloud + On-Premise File Support</li></ul><h2 id="Climate-Model-Interface"><a class="docs-heading-anchor" href="#Climate-Model-Interface">Climate Model Interface</a><a id="Climate-Model-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Climate-Model-Interface" title="Permalink"></a></h2><p>The interface ties the <a href="#ClimateModels.ModelConfig"><code>ModelConfig</code></a> data structure with methods like <a href="#ClimateModels.setup"><code>setup</code></a>, <a href="#ClimateModels.build"><code>build</code></a>, and <a href="#ClimateModels.launch"><code>launch</code></a>. In return, it provides standard methods to deal with inputs and outputs, as well as capabilities described below. </p><p>The <a href="#Base.run"><code>run</code></a> method provides the capability to deploy models in streamlined fashion – with just one code line, or just one click. It executes all three steps at once (<a href="#ClimateModels.setup"><code>setup</code></a>, <a href="#ClimateModels.build"><code>build</code></a>, and <a href="#ClimateModels.launch"><code>launch</code></a>). </p><p>With the simplified <a href="#ClimateModels.ModelConfig"><code>ModelConfig</code></a> constructor, we can then just write:</p><pre><code class="language-julia hljs">f=ClimateModels.RandomWalker
run(ModelConfig(f))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">  ID            = a0bea808-fb57-4866-b947-c323ddedfafc
  model         = RandomWalker
  configuration = anonymous
  run folder    = /tmp/a0bea808-fb57-4866-b947-c323ddedfafc
  log subfolder = /tmp/a0bea808-fb57-4866-b947-c323ddedfafc/log
</code></pre><p>The above example uses <code>ClimateModels.RandomWalker</code> as the model (function <code>f</code>). By design of our interface, it is <strong>required</strong> that <code>f</code> receives a <code>ModelConfig</code> as its sole input argument. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In practice, this requirement is easily satisfied. Input parameters can be specified to <code>ModelConfig</code> via the <code>inputs</code> keyword argument, or via files instead.</p></div></div><p>Often it is most practical to break things down. Let&#39;s start with defining the model:</p><pre><code class="language-julia hljs">MC=ModelConfig(model=f)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">  ID            = 12e08992-aa6a-4b8a-9465-fd0ed436555c
  model         = RandomWalker
  configuration = anonymous
  run folder    = /tmp/12e08992-aa6a-4b8a-9465-fd0ed436555c
  log subfolder = /tmp/12e08992-aa6a-4b8a-9465-fd0ed436555c/log
</code></pre><p>The <code>model</code>&#39;s top level function gets called via <a href="#ClimateModels.launch"><code>launch</code></a>. In our example, <code>f</code> thus generates a file called <code>RandomWalker.csv</code>, which gets stored in the run folder. </p><p>The <code>run</code> sequence is shown below. In practice, <code>setup</code> typically handles files and software, <code>build</code> may compile a chosen model configuration, and <code>launch</code> takes care of the main computation. </p><pre><code class="language-julia hljs">setup(MC)
build(MC)
launch(MC)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Compilation during <code>build</code> is <strong>not a requirement</strong>. It can also be done within <code>launch</code> or beforehand.</p></div></div><p>Sometimes it&#39;s convenient to further break down the computational workflow into several tasks. These can be added to the <code>ModelConfig</code> via <a href="@ref"><code>put!</code></a> and then executed via <code>launch</code>, as demonstrated below.</p><p>The run folder name and its content can be viewed using <a href="#Base.pathof"><code>pathof</code></a> and <a href="#Base.Filesystem.readdir"><code>readdir</code></a>, respectively.</p><pre><code class="language-julia hljs">pathof(MC)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/tmp/12e08992-aa6a-4b8a-9465-fd0ed436555c&quot;</code></pre><pre><code class="language-julia hljs">readdir(MC)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{String}:
 &quot;RandomWalker.csv&quot;
 &quot;log&quot;</code></pre><p>The <code>log</code> subfolder was created earlier by <a href="#ClimateModels.setup"><code>setup</code></a>. The <a href="#Base.log"><code>log</code></a> function retrieves the workflow log. </p><pre><code class="language-julia hljs">log(MC)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{String}:
 &quot;797e337 initial setup&quot;
 &quot;d7b17f1 add Project.toml to log&quot;
 &quot;6654aa9 add Manifest.toml to log&quot;
 &quot;9e7054d task started [35fb971c-64c7-44ee-93a0-faa26e0168ba]&quot;
 &quot;2a6f55d (HEAD -&gt; main) task ended   [35fb971c-64c7-44ee-93a0-faa26e0168ba]&quot;</code></pre><p>This highlights that <code>Project.toml</code> and <code>Manifest.toml</code> for the environment being used have been archived. This happens during <a href="#ClimateModels.setup"><code>setup</code></a> to document all dependencies and make the workflow reproducible.</p><h3 id="Customization"><a class="docs-heading-anchor" href="#Customization">Customization</a><a id="Customization-1"></a><a class="docs-heading-anchor-permalink" href="#Customization" title="Permalink"></a></h3><p>A key point is that everything can be customized to, e.g., use popular models previously written in Fortran or C just as simply. </p><p>The simplest way to use the <code>ClimateModels.jl</code> interface is to specify <code>model</code> directly as a function, and use defaults for everything else, as illustrated in <a href="../examples/RandomWalker.html">random walk</a>. Alternatively, the <code>model</code> name can be provided as a <code>String</code> and the main <code>Function</code> as the <code>configuration</code>, as in <a href="../examples/CMIP6.html">CMIP6</a>.</p><p>Often, however, one may want to define custom <code>setup</code>, <code>build</code>, or <code>launch</code> methods. To this end, one can define a concrete type of <code>AbstractModelConfig</code> using <a href="#ClimateModels.ModelConfig"><code>ModelConfig</code></a> as a blueprint. This is the recommended approach when other languanges like Fortran or Python are involved (e.g., <a href="../examples/Hector.html">Hector</a>, <a href="../examples/FaIR.html">FaIR</a>, <a href="../examples/Speedy.html">SPEEDY</a>, <a href="../examples/MITgcm.html">MITgcm</a>). </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Defining a concrete type of <code>AbstractModelConfig</code> can also be practical with pure Julia model, e.g. to speed up <a href="#ClimateModels.launch"><code>launch</code></a>, generate ensembles, facilitate checkpointing, etc. That&#39;s the case in the <a href="../examples/Oceananigans.html">Oceananigans.jl</a> example.</p></div></div><p>For popular models the customized interface elements can be provided via a dedicated package. This may allow them to be maintained independently by developers and users most familiar with each model. <a href="https://github.com/gaelforget/MITgcmTools.jl">MITgcmTools.jl</a> does this for <a href="https://mitgcm.readthedocs.io/en/latest/">MITgcm</a>. It provides its own suite of examples that use the <code>ClimateModels.jl</code> interface.</p><h3 id="Additional-Example"><a class="docs-heading-anchor" href="#Additional-Example">Additional Example</a><a id="Additional-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Example" title="Permalink"></a></h3><p>In this example, we illustrate how one can interact with model parameters and rerun models. After an initial model run of 100 steps, duration <code>NS</code> is extended to 200 time steps. The <code>put!</code> and <code>launch</code> sequence then reruns the model. </p><p>The same method can be used to break down a workflow in several steps. Each call to <a href="#ClimateModels.launch"><code>launch</code></a> sequentially takes the next task from the stack (i.e., <code>channel</code>). Once the task <code>channel</code> is empty then <code>launch</code> does nothing.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The call sequence is readily reflected in the workflow log, and the run dir now has two output files. The modified parameters are also automatically recorded in <code>tracked_parameters.toml</code> during <code>launch</code>.</p></div></div><pre><code class="language-julia hljs">MC=ModelConfig(f,(NS=100,filename=&quot;run01.csv&quot;))
run(MC)

MC.inputs[:NS]=200
MC.inputs[:filename]=&quot;run02.csv&quot;
put!(MC)
launch(MC)

log(MC)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9-element Vector{String}:
 &quot;6919192 initial setup&quot;
 &quot;2891563 initial tracked_parameters.toml&quot;
 &quot;f978eda add Project.toml to log&quot;
 &quot;eee0a52 add Manifest.toml to log&quot;
 &quot;e813342 task started [8d5d3bd4-b915-4c09-8250-82a580d731ce]&quot;
 &quot;36796e4 task ended   [8d5d3bd4-b915-4c09-8250-82a580d731ce]&quot;
 &quot;960f488 task started [55e34303-2bf9-429a-9b7b-4c4182f05bc5]&quot;
 &quot;c015c72 modify tracked_parameters.toml&quot;
 &quot;e290964 (HEAD -&gt; main) task ended   [55e34303-2bf9-429a-9b7b-4c4182f05bc5]&quot;</code></pre><pre><code class="language-julia hljs">readdir(MC)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{String}:
 &quot;log&quot;
 &quot;run01.csv&quot;
 &quot;run02.csv&quot;
 &quot;tmp.txt&quot;</code></pre><h2 id="Tracked-Worklow-Support"><a class="docs-heading-anchor" href="#Tracked-Worklow-Support">Tracked Worklow Support</a><a id="Tracked-Worklow-Support-1"></a><a class="docs-heading-anchor-permalink" href="#Tracked-Worklow-Support" title="Permalink"></a></h2><p>The <code>setup</code> method normally calls <a href="#Base.log"><code>log</code></a> to create a temporary run folder with a <code>git</code> enabled subfolder called <code>log</code>. This allows for recording each workflow step, using <a href="#Base.log"><code>log</code></a> functions listed below. </p><p>Calling <code>log</code> on a <code>ModelConfig</code> without any other argument shows the workflow record. This feature is as illustrated several times in the above examples.</p><h2 id="File-and-Cloud-Support"><a class="docs-heading-anchor" href="#File-and-Cloud-Support">File and Cloud Support</a><a id="File-and-Cloud-Support-1"></a><a class="docs-heading-anchor-permalink" href="#File-and-Cloud-Support" title="Permalink"></a></h2><p>There are various ways that numerical model output gets archived, distributed, and retrieved from the internet. In some cases downloading data can be the most convenient approach. In others it can be more advantageous to compute in the cloud and only download final results for plotting. </p><p><code>ClimateModels.jl</code> comes equiped with packages that read popular file formats used in climate modeling and science. <a href="https://github.com/JuliaLang/Downloads.jl">Downloads.jl</a>, <a href="https://github.com/JuliaData/CSV.jl">CSV.jl</a>, <a href="https://github.com/JuliaData/DataFrames.jl">DataFrames.jl</a>, <a href="https://github.com/JuliaGeo/NetCDF.jl">NetCDF.jl</a>, <a href="https://github.com/meggart/Zarr.jl">Zarr.jl</a>, and <a href="https://github.com/JuliaLang/TOML.jl">TOML.jl</a> are thus readily available when you install <code>ClimateModels.jl</code>. For instance, one can read the CSV file generated before as</p><pre><code class="language- hljs">fil=joinpath(pathof(MC),&quot;RandomWalker.csv&quot;)
CSV=ClimateModels.CSV # hide
DataFrame=ClimateModels.DataFrame #hide
CSV.File(fil) |&gt; DataFrame
summary(ans) # hide</code></pre><p>For additional examples covering other file formats, please refer to the <a href="../examples/IPCC.html">IPCC report</a> and <a href="../examples/CMIP6.html">CMIP6 archive</a> notebooks and code links.</p><h2 id="Data-Structure"><a class="docs-heading-anchor" href="#Data-Structure">Data Structure</a><a id="Data-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structure" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.ModelConfig" href="#ClimateModels.ModelConfig"><code>ClimateModels.ModelConfig</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ModelConfig &lt;: AbstractModelConfig</code></pre><pre><code class="nohighlight hljs">model :: Union{Function,String,Pkg.Types.PackageSpec} = &quot;anonymous&quot;
configuration :: Union{Function,String} = &quot;anonymous&quot;
options :: OrderedDict{Any,Any} = OrderedDict{Any,Any}()
inputs :: OrderedDict{Any,Any} = OrderedDict{Any,Any}()
outputs :: OrderedDict{Any,Any} = OrderedDict{Any,Any}()
status :: OrderedDict{Any,Any} = OrderedDict{Any,Any}()
channel :: Channel{Any} = Channel{Any}(10) 
folder :: String = tempdir()
ID :: UUID = UUIDs.uuid4()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL6-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.ModelConfig-Tuple{Function}" href="#ClimateModels.ModelConfig-Tuple{Function}"><code>ClimateModels.ModelConfig</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ModelConfig(func::Function,inputs::NamedTuple)</code></pre><p>Simplified constructor for case when model is a Function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.PkgDevConfig" href="#ClimateModels.PkgDevConfig"><code>ClimateModels.PkgDevConfig</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PkgDevConfig(url::String,func::Function,inputs::NamedTuple)</code></pre><p>Simplified constructor for case when model is a url (PackageSpec).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL43-L47">source</a></section></article><h2 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.setup" href="#ClimateModels.setup"><code>ClimateModels.setup</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">setup(MC::AbstractModelConfig,PlutoFile::String)</code></pre><ul><li>Call default <code>setup</code> then</li><li>Call <code>notebooks.unroll</code></li><li>Consolidate <code>main.jl</code> (activate, instantiate)</li></ul><pre><code class="nohighlight hljs">MC1=ModelConfig()
notebooks.setup(MC1,&quot;examples/CMIP6.jl&quot;)

cd(joinpath(pathof(MC1),&quot;run&quot;))
include(&quot;main.jl&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/notebooks.jl#LL144-L158">source</a></section><section><div><pre><code class="nohighlight hljs">setup(x)</code></pre><p>Defaults to <code>default_ClimateModelSetup(x)</code>. Can be expected to be  specialized for most concrete types of <code>AbstractModelConfig</code></p><pre><code class="nohighlight hljs">f=ClimateModels.RandomWalker
tmp=ModelConfig(model=f)
setup(tmp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL88-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.build" href="#ClimateModels.build"><code>ClimateModels.build</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build(x)</code></pre><p>Defaults to <code>default_ClimateModelBuild(x)</code>. Can be expected to be  specialized for most concrete types of <code>AbstractModelConfig</code></p><pre><code class="language-julia hljs">using ClimateModels
tmp=ModelConfig(model=ClimateModels.RandomWalker)
setup(tmp)
build(tmp)

isa(tmp,AbstractModelConfig) # hide</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL212-L230">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.launch" href="#ClimateModels.launch"><code>ClimateModels.launch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">launch(x)</code></pre><p>Defaults to <code>default_ClimateModelLaunch(x)</code> which consists in <code>take!(x)</code> for <code>AbstractModelConfig</code>. Can be expected to be specialized for most  concrete types of <code>AbstractModelConfig</code></p><pre><code class="nohighlight hljs">f=ClimateModels.RandomWalker
tmp=ModelConfig(model=f)
setup(tmp)
build(tmp)
launch(tmp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL268-L282">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.run" href="#Base.run"><code>Base.run</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run(x :: AbstractModelConfig)</code></pre><p>Shorthand for <code>setup |&gt; build |&gt; launch</code>, which returns <code>AbstractModelConfig</code> as output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.log" href="#Base.log"><code>Base.log</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">log(x :: AbstractModelConfig)</code></pre><p>Show the record of git commits that have taken place in the <code>log</code> folder.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL548-L552">source</a></section><section><div><pre><code class="nohighlight hljs">log(x :: AbstractModelConfig, commit_msg :: String; 
             fil=&quot;&quot;, msg=&quot;&quot;, init=false, prm=false)</code></pre><p>Keyword arguments work like this </p><ul><li><code>init==true</code> : create <code>log</code> subfolder, initialize git, and commit initial README.md</li><li><code>prm==true</code>  : add files found in <code>input</code> or <code>tracked_parameters/</code> (if any) to git log</li><li><code>!isempty(fil)</code> : commit changes to file <code>log/$(fil)</code> with message <code>commit_msg</code>.   If <code>log/$(fil)</code> is unknown to git (i.e. commit errors out) then try adding <code>log/$(fil)</code> first. </li></ul><p>and are mutually exclusive (i.e., use only one at a time).</p><pre><code class="nohighlight hljs">MC=run(ModelConfig(ClimateModels.RandomWalker,(NS=100,)))
MC.inputs[:NS]=200
msg=&quot;update tracked_parameters.toml (or skip if up to date)&quot;
log(MC,msg,fil=&quot;tracked_parameters.toml&quot;,prm=true)
log(MC)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL555-L575">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Base.pathof" href="#Base.pathof"><code>Base.pathof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pathof(x::AbstractModelConfig)</code></pre><p>Returns the run directory path for x ; i.e. joinpath(x.folder,string(x.ID))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.Filesystem.readdir" href="#Base.Filesystem.readdir"><code>Base.Filesystem.readdir</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">readdir(x::AbstractModelConfig)</code></pre><p>Same as readdir(pathof(x)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL61-L65">source</a></section><section><div><pre><code class="nohighlight hljs">readdir(x::AbstractModelConfig,subfolder::String)</code></pre><p>Same as readdir(joinpath(pathof(x),subfolder)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.show" href="#Base.show"><code>Base.show</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">show(io::IO, z::AbstractModelConfig)</code></pre><pre><code class="nohighlight hljs">tmp=ModelConfig(model=ClimateModels.RandomWalker)
setup(tmp)
show(tmp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL337-L345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.clean" href="#ClimateModels.clean"><code>ClimateModels.clean</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">clean(x :: AbstractModelConfig)</code></pre><p>Cancel any remaining task (x.channel) and rm the run directory (pathof(x))</p><pre><code class="nohighlight hljs">tmp=ModelConfig(model=ClimateModels.RandomWalker)
setup(tmp)
clean(tmp)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/interface.jl#LL289-L299">source</a></section></article><h2 id="Notebooks"><a class="docs-heading-anchor" href="#Notebooks">Notebooks</a><a id="Notebooks-1"></a><a class="docs-heading-anchor-permalink" href="#Notebooks" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>notebooks.setup</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="ClimateModels.notebooks.unroll" href="#ClimateModels.notebooks.unroll"><code>ClimateModels.notebooks.unroll</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">unroll(PlutoFile::String; EnvPath=&quot;&quot;)</code></pre><p>Extract main program, <code>Project.toml</code>, and <code>Manifest.toml</code> from Pluto notebook file <code>PlutoFile</code>.  Save them in folder <code>EnvPath</code> (default = temporary folder). Typical use case is shown below.</p><pre><code class="nohighlight hljs">p,f=notebooks.unroll(&quot;CMIP6.jl&quot;)
cd(p)
Pkg.activate(&quot;./&quot;)
Pkg.instantiate()
include(f)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/notebooks.jl#LL96-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.open" href="#Base.open"><code>Base.open</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">open(;notebook_path=&quot;&quot;,notebook_url=&quot;&quot;,
      pluto_url=&quot;http://localhost:1234/&quot;,pluto_options=&quot;...&quot;)</code></pre><p>Open notebook in web-browser via Pluto. <strong>Important note:</strong> this assumes that the Pluto server is already running, e.g. from <code>Pluto.run()</code>, at URL <code>pluto_url</code> (by default, &quot;http://localhost:1234/&quot;, should work on a laptop or desktop).</p><p>Simple examples:</p><pre><code class="nohighlight hljs">notebooks.open(notebook_path=&quot;examples/defaults.jl&quot;)

nbs=notebooks.list()
notebooks.open(notebook_url=nbs.url[1])</code></pre><p>More examples:</p><pre><code class="nohighlight hljs">nbs=notebooks.list()
path=joinpath(tempdir(),&quot;nbs&quot;)
notebooks.download(path,nbs)

pluto_url=&quot;https://ade.ops.maap-project.org/serverpmohyfxe-ws-jupyter/server-3100/pluto/&quot;

ii=1
notebook_path=joinpath(path,nbs.folder[ii],nbs.file[ii])
notebooks.open(pluto_url=pluto_url,notebook_path=notebook_path)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaelforget/ClimateModels.jl/blob/5b17ebb9d5e76c4d7c58b296c8ff7d826ea6a4ba/src/notebooks.jl#LL52-L80">source</a></section></article><h3 id="Package-Development-Mode"><a class="docs-heading-anchor" href="#Package-Development-Mode">Package Development Mode</a><a id="Package-Development-Mode-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Development-Mode" title="Permalink"></a></h3><p>The defining feature of this alternative method is specifying <code>model</code> as a <code>PackageSpec</code>. This makes <a href="#ClimateModels.setup"><code>setup</code></a> install the chosen package using <code>Pkg.develop</code>. This allows for developing a package or using an unregistered package in the context of <code>ClimateModels.jl</code>. </p><p>There are two common cases: </p><ul><li>if <code>configuration</code> is left undefined then <code>launch</code> will run the package test suite using <code>Pkg.test</code> as in <a href="../examples/defaults.html">this example</a> (<a href="https://raw.githubusercontent.com/gaelforget/ClimateModels.jl/master/examples/defaults.jl">code link</a>)</li><li>if <code>configuration</code> is provided as a <code>Function</code> then <code>launch</code> will call it as illustrated in the <a href="../examples/ShallowWaters.html">ShallowWaters.jl example</a> (<a href="https://raw.githubusercontent.com/gaelforget/ClimateModels.jl/master/examples/ShallowWaters.jl">code link</a>)</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>As an exercise, can you turn <a href="../examples/ShallowWaters.html">ShallowWaters.jl example</a> into a <em>normal user mode</em> example?</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Wednesday 24 August 2022 01:47">Wednesday 24 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
